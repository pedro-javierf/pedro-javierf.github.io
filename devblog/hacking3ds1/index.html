<!DOCTYPE html>
<html lang='en'><head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='Hello back! Today, a new series begin. A &ldquo;journey&rdquo; into hacking the Nintendo 3DS Handheld Console starts. There are several reasons why I am going to do this series;
 Personal Interest. During the later 2014, the 3DS Scene started growing. I was there, and was told I couldn&rsquo;t get anything. The obnoxious sceners and community, only working for fame and personal interest. The lack of information and documentation about hacking blindly (Which is basically what I&rsquo;ll be doing here) Exploit development is exciting and challenging'>
<meta name='theme-color' content='#6aff00'>

<meta property='og:title' content='Hacking The 3ds I: Introduction ‚Ä¢ Dangling Pointr'>
<meta property='og:description' content='Hello back! Today, a new series begin. A &ldquo;journey&rdquo; into hacking the Nintendo 3DS Handheld Console starts. There are several reasons why I am going to do this series;
 Personal Interest. During the later 2014, the 3DS Scene started growing. I was there, and was told I couldn&rsquo;t get anything. The obnoxious sceners and community, only working for fame and personal interest. The lack of information and documentation about hacking blindly (Which is basically what I&rsquo;ll be doing here) Exploit development is exciting and challenging'>
<meta property='og:url' content='https://pedro-javierf.github.io/devblog/Hacking3ds1/'>
<meta property='og:site_name' content='Dangling Pointr'>
<meta property='og:type' content='article'><meta property='article:section' content='devblog'><meta property='article:published_time' content='2017-06-12T11:17:57&#43;02:00'/><meta property='article:modified_time' content='2017-06-12T11:17:57&#43;02:00'/><meta name='twitter:card' content='summary'>

<meta name="generator" content="Hugo 0.59.1" />

  <title>Hacking The 3ds I: Introduction ‚Ä¢ Dangling Pointr</title>
  <link rel='canonical' href='https://pedro-javierf.github.io/devblog/Hacking3ds1/'>
  
  <link rel='alternate' hreflang='en' href='https://pedro-javierf.github.io/devblog/Hacking3ds1/'><link rel='alternate' hreflang='x-default' href='https://pedro-javierf.github.io/devblog/Hacking3ds1/'><link rel='alternate' hreflang='es' href='https://pedro-javierf.github.io/es/devblog/Hacking3ds1/'>
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.ab98e12b.css'><link rel='stylesheet' href='/css/custom.css'><style>
:root{--color-accent:#6aff00;}
</style>

  

</head>

<meta name="twitter:image:src" content="https://pedro-javierf.github.io/images/logo.png"> 
<script src="https://kit.fontawesome.com/4cb33814ad.js" crossorigin="anonymous"></script>
<script>var clicky_site_ids = clicky_site_ids || []; clicky_site_ids.push(101275982);</script>
<script async src="//static.getclicky.com/js"></script>
<link disabled id="dark-mode-theme" rel="stylesheet" href="/assets/css/dark.css">
<body class='page type-devblog has-sidebar'>

  <div class='site'><div id='sidebar' class='sidebar'>
  <a class='screen-reader-text' href='#main-menu'>Skip to Main Menu</a>

  <div class='container'><section class='widget widget-about sep-after'>
  <header>
    
    <div class='logo'>
      <a href='/'>
        <img src='/images/logo.png'>
      </a>
    </div>
    
    <h2 class='title site-title '>
      <a href='/'>
      Dangling Pointr
      </a>
    </h2>
    <div class='desc'>
    Your blog about hacking, learning and tech
    </div>
  </header>

</section>
<section class='widget widget-sidebar_menu sep-after'><nav id='sidebar-menu' class='menu sidebar-menu' aria-label='Sidebar Menu'>
    <div class='container'>
      <ul><li class='item'>
  <a href='/'>Home</a></li><li class='item'>
  <a href='/devblog/'>Devblog üñ•Ô∏è</a></li><li class='item'>
  <a href='/talks/'>Talks üó£Ô∏è</a></li><li class='item'>
  <a href='/gaming/'>Gaming üéÆ</a></li><li class='item'>
  <a href='/misc/'>Misc üéµ</a></li><li class='item'>
  <a href='/about/'>About</a></li></ul>
    </div>
  </nav>

</section>
  <a id="dark-mode-toggle">Dark Mode</a><br>
  
  
  </div>

  <div class='sidebar-overlay'></div>
</div><div class='main'><nav id='main-menu' class='menu main-menu' aria-label='Main Menu'>
  <div class='container'>
    <a class='screen-reader-text' href='#content'>Skip to Content</a>

<button id='sidebar-toggler' class='sidebar-toggler' aria-controls='sidebar'>
  <span class='screen-reader-text'>Toggle Sidebar</span>
  <span class='open'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="3" y1="12" x2="21" y2="12" />
  <line x1="3" y1="6" x2="21" y2="6" />
  <line x1="3" y1="18" x2="21" y2="18" />
  
</svg>
</span>
  <span class='close'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
  
</svg>
</span>
</button>
    <ul><li class='item'>
        <a href='/'>Home</a>
      </li><li class='item'>
        <a href='/devblog/'>Devblog üñ•Ô∏è</a>
      </li><li class='item'>
        <a href='/talks/'>Talks üó£Ô∏è</a>
      </li><li class='item'>
        <a href='/gaming/'>Gaming üéÆ</a>
      </li><li class='item'>
        <a href='/misc/'>Misc üéµ</a>
      </li><li class='item'>
        <a href='/about/'>About</a>
      </li><li class='item'>
        <a href='/es/'><i class='fa fa-language'></i> Change Language</a>
      </li></ul>
  </div>
</nav><div class='header-widgets'>
        <div class='container'></div>
      </div>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>Dangling Pointr</p><p class='desc site-desc'>Your blog about hacking, learning and tech</p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Hacking The 3ds I: Introduction</h1>
      

    </div>
    <div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2017-06-12T11:17:57&#43;02:00'>2017, Jun 12</time>
</span>

  
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
5 mins read
</span>


</div>


  </div>
</header>

  
  

  <div class='container entry-content'>
  <p>Hello back!<br/>
Today, a new series begin. A &ldquo;journey&rdquo; into hacking the Nintendo 3DS Handheld Console starts. There are several reasons why I am going to do this series;<br />
<ul>
  <li>Personal Interest. During the later 2014, the 3DS Scene started growing. I was there, and was told I couldn&rsquo;t get anything.</li>
  <li>The obnoxious sceners and community, only working for fame and personal interest.</li>
  <li>The lack of information and documentation about hacking blindly (Which is basically what I&rsquo;ll be doing here)</li>
  <li>Exploit development is exciting and challenging </li>
</ul></p>

<p><h2 class='elegantshadow'>Introduction</h1>
Before doing anything, we need to know what is inside the 3DS. The inner hardware is what defines how the software works. In a first moment, we would open the console and look at the chips to identify them. This is mostly the work of hardware hackers. The Old3DS has this specs (from 3dbrew):</p>

<ul>
  <li>128mb (2x64) of RAM (FCRam)</li>
  <li>"DMP PICA" GPU</li>
  <li>6mb of VRAM (Video RAM, This is a dedicated RAM for the GPU)</li>
  <li>ARM11 2x MPCORE at 268MHz</li>
  <li>ARM9 46 at 134MHz</li>
</ul>
This are the most important pieces of hardware that we should have always in account. For extended details and New3ds information see<a href="https://www.3dbrew.org/wiki/Hardware"> this </a><br/><br/>

<center>
<img src="img/3ds.png">
</center>

In this series, I'll be talking about the MSET Exploit. Again, back in the late 2014, the Gateway Team released the Gateway 3DS Cartridge, which allowed piracy on 4.1 to 4.5 firmwares. They used an exploit on the DS Profile menu in the 3ds settings which then loaded further code from the Launcher.dat file on the SD Card. Some people were able to reverse their Launcher before they implemented more strong obfuscation, but this still was and is a seriously difficult task. My aim is to gain code execution using this exploit without reversing others' work, just by myself and my investigations, as if there were no public information (and actually there's not much information available, and obviously not documentation).  
<h2 class='elegantshadow'> Thoughts</h2>
So basically, we have no information about anything. We are working with what is often called a "Black Box" system. The first step is hardware hacking; Is the only thing we have access to so we must start working there. Hardware is more complex with every passing day. This means that I can't do anything here by myself. Usually a career in electronics or related helps, but unfortunately until a few years ago there wasn't much information available. Sadly most people don't share their investigations publicy (for good reasons often, like avoiding legal problems or encouraging piracy). So unless you find someone with the same hardware you have and interest in hacking it, you are screwed. This is the most common scenario in console hacking, there's no public scene because those discoveries are private and only shared with certain people, otherwise the security holes would be patched quickly. <br/><br/>


<br>As for now, lets assume we are skilled enough to perform any of the possible hardware attacks. What shall we do first? <br/>
We must look in the different data sources in the hardware and decide if they are useful for us. For example, The 3ds has the following:<br/><br>
<ul>
  <li>NAND Chip</li>
  <li>SD Card</li>
  <li>RAM Chips</li>
</ul>
Let's start with the NAND. In the 3ds, this is a 1GB samsung storage unit. So investigating it's datasheet and experimenting, we would eventually be able to dump its contents, as explained in post 4(IV). If we would analyse the dump carefully, we could try the following;<br/> 
<br><ul>
  <li>Find Strings: Such as user data, menu's text, etc..<br/></li>
  <li>Find structures or patterns: such as MAGIC signatures/numbers, headers' information (i.e. ELF), etc...<br/></li>
  <li>Modify the dump: Try modify any byte at the dump and restore it to the chip. See if it boots or it raises any error.<br/></li>
  <li>Restore another NAND dump, gotten from another unit (not the same console).<br/><br/></li>
</ul>

<p>For the 3ds, the result for each test are:
<ul>
  <li>Can&rsquo;t find any string</li>
  <li>Can&rsquo;t find any known pattern, signature or magic. </li>
  <li>Errors when we restore a modified NAND dump. May be encrypted, signed or both</li>
  <li>Errors when we restore a foreign NAND dump. May be signed with unique keys per console.</li>
</ul>
So we can lead to the conclusion that the NAND is somehow encrypted, signed, or both.<br/></p>

<p>Let&rsquo;s move on to the next possible entry-point, the SD card. It is accessible from a PC and we can browse the files. We could try to:
<ul>
  <li>Identify what kind of files we have. It can have content such as, pictures, videos, music, titles (applications or games), exdata(extra data), others.</li>
  <li>Identify which of the things above are signed or encrypted. Try modifying them and see if they still work. Multimedia is likely going to be clear data, but titles, exdata and everything else is probably going to be, at least, console signed.</li>
  <li>Try to exploit the multimedia managers. Use fuzzers to create multimedia files and try loading them. You may find crashes, and who knows, maybe an exploit, like &ldquo;soundhax&rdquo; which was found a lot of years later. </li> <!--Link here for the 3ds soundhax-->
</ul>
Sadly, this is very difficult at this point when we know little - if any - details of the system.<br/><br/></p>

<p>And our last option, the RAM. We would need a working hardware set-up that would allow us to dump the ram (see scanlime set-up above). This has been done in the 3ds by some hardware hackers, but the ones who did it did not release much details, and likely sold the work for money, so it is not available to the public ;). Assuming we have dumped the RAM, let&rsquo;s proceed to analyse the dumps. We would try, but not only, the same ideas as for the NAND chip. In the 3ds, we find that RAM contents are not encrypted! We can, in fact, find strings from menus (most of them in unicode).</p>

<p><h2 class='elegantshadow'> Conclusion</h2>
Analysing the RAM requires a whole article or two; I will be using some new techniques which may lead to code execution, and definitively, there&rsquo;s going to be a lot of static reverse engineering.<br/></p>

<p>I hope you enjoyed this post. If you consider any suggestion/correction, message me at twitter or mail me.</p>

</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'>
  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/devblog/Hacking3ds0/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>Hacking The 3ds 0: Resources</a>
    </div><div class='next-entry sep-before'>
      <a href='/devblog/Hacking3ds2/'>
        <span class='screen-reader-text'>Next post: </span>Hacking The 3ds II: Finding the Pattern<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>


<section id='comments' class='comments'>
  <div class='container sep-before'>
    <div class='comments-area'><div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "pjplayground" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
  </div>
</section>

      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><section class='widget widget-social_menu sep-after'><nav aria-label='Social Menu'>
    <ul><li>
        <a href='https://github.com/pedro-javierf' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Github account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
</a>
      </li><li>
        <a href='https://twitter.com/DanglingPointr' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Twitter account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
  
</svg>
</a>
      </li><li>
        <a href='https://linkedin.com/in/pedro-javier-fern%c3%a1ndez-29a998101' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Linkedin account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/>
  <rect x="2" y="9" width="4" height="12"/>
  <circle cx="4" cy="4" r="2"/>
  
</svg>
</a>
      </li></ul>
  </nav>
</section><div class='copyright'>
  <p> &copy; 2017-2020  </p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__assets_js_src="/assets/js/"</script>

<script src='/assets/js/main.c3bcf2df.js'></script><script src='/js/custom.js'></script>

</body>

</html>

